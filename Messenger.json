{
  "name": "Messenger",
  "nodes": [
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [1456, -16],
      "id": "65c70b38-b554-404e-aab1-8a282d3e8035",
      "name": "OpenAI Chat Model"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.body.message }}",
        "options": {
          "systemMessage": "=# Felipe Su√°rez - AI Sales Agent (Direct Sales Mode)\n\n[...contenido del mensaje del sistema omitido para brevedad...]"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.1,
      "position": [1600, -224],
      "id": "5e649d36-b67c-4508-a602-3e90f8c37446",
      "name": "Felipe Suarez"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Use this to get information about services and prices",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "useReranker": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [1824, 96],
      "id": "1b944c05-584e-4b0b-9719-f143f252cae2",
      "name": "Supabase Vector Store"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Webhook1').item.json.body.sessionId }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [1632, 48],
      "id": "e31fbbd8-84d7-41a8-a72a-0e9bd422da06",
      "name": "Postgres Chat Memory"
    },
    {
      "parameters": {
        "options": {
          "responseCode": 200,
          "responseHeaders": {
            "entries": [
              { "name": "Content-Type", "value": "application/json" },
              { "name": "Access-Control-Allow-Credentials", "value": "true" }
            ]
          }
        }
      },
      "id": "147728f5-2db6-4541-902c-5f2af653737e",
      "name": "Webhook Response1",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [2304, -224]
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": ["POST"],
        "path": "4eb21d65-6dfe-4816-88cf-323664347d0d",
        "responseMode": "responseNode",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Credentials", "value": "true" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type" }
            ]
          }
        }
      },
      "id": "ad3972e1-1253-468a-983f-b3ceea14952f",
      "name": "Webhook1",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [1264, -224],
      "webhookId": "4eb21d65-6dfe-4816-88cf-323664347d0d"
    },
    {
      "parameters": {
        "sseEndpoint": "https://example.ngrok-free.app/mcp/stripe"
      },
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "typeVersion": 1,
      "position": [2224, 144],
      "id": "1fde1118-35b0-4a33-b5b8-b6f1ae9c8171",
      "name": "Stripe"
    },
    {
      "parameters": {
        "sseEndpoint": "https://example.ngrok-free.app/mcp/calendar"
      },
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "typeVersion": 1,
      "position": [2448, -112],
      "id": "b79ec7bb-8c18-4ed4-8294-b8ebddd50a83",
      "name": "Calendar agent"
    },
    {
      "parameters": {
        "sseEndpoint": "https://example.ngrok-free.app/mcp/gmail"
      },
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "typeVersion": 1,
      "position": [2384, 48],
      "id": "c4262205-519a-4d0b-983e-c410beac8633",
      "name": "Gmail Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [1808, 256],
      "id": "0fb50c09-5896-4493-a8ca-4eb7ddbef4fa",
      "name": "Embeddings OpenAI"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "example-file-id",
          "mode": "list",
          "cachedResultName": "Precios y servicios Felipe Suarez"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [1008, 288],
      "id": "ef99340c-bd3e-47d2-8fc5-b2d8cf747fda",
      "name": "Download file"
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [1216, 288],
      "id": "6f9b70a9-72e4-4770-974e-fcfdc8cae9a2",
      "name": "Supabase Vector Store1"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [2000, 240],
      "id": "bfc910a8-a0a1-475e-b5db-54380affa4b6",
      "name": "Reranker Cohere"
    }
  ],
  "connections": {},
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "cleaned-version",
  "meta": {
    "templateCredsSetupCompleted": false
  },
  "id": "cleaned-messenger",
  "tags": []
}
